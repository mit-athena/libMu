Top = /mit/motif
LibDir = $(Top)/$(MACHINE)lib
IncludeDir = $(Top)/include
IncludePath = -I$(IncludeDir) 
LibPath = -L$(LibDir)
Libs = -lMrm -lXm -lXt -lX11
InstallLib = $(Top)/$(MACHINE)lib
InstallBin = $(Top)/$(MACHINE)bin
InstallMan = $(Top)/man
InstallDoc = $(Top)/doc

UIL = uil
CC = gcc
CFLAGS = -g $(IncludePath)

LIBMUSRCS = \
MuGetBoolean.c \
MuGetFileName.c \
MuGetString.c \
MuHelp.c \
MuHelpFile.c \
MuInitialize.c \
MuModalDialogs.c \
MuRegisterNames.c \
MuRegisterWidget.c \
MuSetCursor.c \
MuSetEmacsBindings.c \
MuSetTextTraversal.c \
MuSyncDialogs.c \
_MuCallbacks.c 

LIBMUOBJS = \
MuGetBoolean.o \
MuGetFileName.o \
MuGetString.o \
MuHelp.o \
MuHelpFile.o \
MuInitialize.o \
MuModalDialogs.o \
MuRegisterNames.o \
MuRegisterWidget.o \
MuSetCursor.o \
MuSetEmacsBindings.o \
MuSetTextTraversal.o \
MuSyncDialogs.o \
_MuCallbacks.o 

DOCSRC = \
man/man3/libMu.3X \
man/man1/mockup.1 \
man/man3/MuError.3X \
man/man3/MuErrorSync.3X \
man/man3/MuGetBoolean.3X \
man/man3/MuGetFilename.3X \
man/man3/MuGetString.3X \
man/man3/MuHelpFile.3X \
man/man3/MuInitialize.3X \
man/man3/MuRegsiterNames.3X \
man/man3/MuRegisterWidget.3X \
man/man3/MuSetEmacsBindings.3X \
man/man3/MuSetTextTraversal.3X \
man/man3/MuSetWaitCursor.3X 


all: libMu.a mockup document

libMu.a: $(LIBMUOBJS)
	rm -f libMu.a
	ar clq libMu.a $(LIBMUOBJS)
	ranlib libMu.a

$(LIBMUOBJS): Mu.h MuP.h

mockup: mockup.o libMu.a
	$(CC) $(CFLAGS) -o mockup mockup.o libMu.a $(LibPath) $(Libs)

document: MotifUtilities.PS

MotifUtilities.PS: $(DOCSRC)
	psroff -man -t $(DOCSRC) > MotifUtilities.PS

install: libMu.a mockup document
	cp libMu.a $(InstallLib)		# install libMu.a
	ranlib -t $(InstallLib)/libMu.a		# re-ranlib it
	cp mockup $(InstallBin)			# install mockup
	strip $(InstallBin)/mockup		# strip it
	cp Mu.h $(IncludeDir)			# install C header file
	cp Mu.uil $(IncludeDir)/uil		# install uil header file
	cp MotifUtilities.PS $(InstallDoc)	# install document
	cp man/man1/* $(InstallMan)/man1	# install man pages sec. 1
	cp man/man3/* $(InstallMan)/man3	# install man pages sec. 3
	catman -M $(InstallMan)			# format man pages

test: TestMu

TestMu: TestMu.o TestMu.uid libMu.a
	$(CC) $(CFLAGS) -o TestMu TestMu.o libMu.a $(LibPath) $(Libs)

TestMu.uid: TestMu.uil
	$(UIL) -I$(IncludeDir)/uil -o TestMu.uid TestMu.uil

clean: 
	rm -f libMu.a mockup TestMu
	rm -f *.o *.uid *~ core

saber:
	saber $(CFLAGS) $(LIBMUSRCS)


